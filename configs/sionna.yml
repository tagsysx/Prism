base_station:
  antenna_embedding_dim: 32
  antenna_type: mimo
  num_antennas: 64  # Sionna has 64 BS antennas (8x8 array)
  antenna_array:
    configuration: "8x8"  # Sionna has 8x8 BS antenna array
    spacing_x: 0.0429  # Antenna spacing in x direction (half wavelength at 3.5 GHz)
    spacing_y: 0.0429  # Antenna spacing in y direction (half wavelength at 3.5 GHz)
  ofdm:
    bandwidth: 100.0e6  # Sionna bandwidth: 100 MHz
    center_frequency: 3.5e9  # Sionna frequency: 3.5 GHz
    fft_size: 512
    guard_band_ratio: 0.1
    num_guard_carriers: 52
    num_subcarriers: 408  # Sionna has 408 subcarriers
    subcarrier_spacing: 245.1e3  # Sionna subcarrier spacing: 245.1 kHz

tracing:
  max_ray_length: 250.0
  num_sampling_points: 16
  use_ipe_encoding: true
  num_bs_antennas: 64  # Sionna has 64 BS antennas
  num_subcarriers: 408  # Sionna has 408 subcarriers
  use_mixed_precision: false

input:
  dataset_path: data/sionna/results  # Sionna dataset path
  random_seed: 42
  subcarrier_sampling:
    antenna_consistent: true
    sampling_method: uniform
    sampling_ratio: 1
  train_ratio: 0.8
  # Phase calibration configuration
  phase_calibration:
    enabled: true
    reference_subcarrier_index: 0  # Use first subcarrier (index 0) as reference for Sionna

neural_networks:
  antenna_codebook:
    embedding_dim: 32
    initialization: normal
    normalize: false
    num_bs_antennas: 64  # Sionna has 64 BS antennas
    std: 0.1
  attenuation_network:
    activation: relu
    feature_dim: 128
    hidden_dim: 64
    num_layers: 3
    output_dim: 32
    use_shortcuts: true
  csi_network:
    d_model: 256
    n_layers: 4
    n_heads: 16
    d_ff: 1024
    dropout_rate: 0.05
    # Add smoothing regularization
    smoothing_weight: 0.1
    # Add magnitude constraint
    magnitude_constraint: true
    max_magnitude: 5.0
  frequency_codebook:
    basis_dim: 32
    initialization: complex_normal
    std: 0.1
    normalize: false
  prism_network:
    antenna_embedding_dim: 32
    azimuth_divisions: 18
    elevation_divisions: 6
    num_bs_antennas: 64  # Sionna has 64 BS antennas
    num_subcarriers: 408  # Sionna has 408 subcarriers
  radiance_network:
    activation: relu
    antenna_embedding_dim: 32
    feature_dim: 128
    hidden_dim: 64
    num_layers: 2
    output_dim: 32
    ue_position_dim: 63
    view_direction_dim: 63

output:
  base_dir: results/sionna
  training:
    checkpoint_dir: '{{base_dir}}/training/checkpoints'
    log_dir: '{{base_dir}}/training/logs'
    log_file: '{{base_dir}}/training/logs/training.log'
    log_level: INFO
    models_dir: '{{base_dir}}/training/models'
    tensorboard_dir: '{{base_dir}}/training/tensorboard'

system:
  device: cuda
  fallback_to_cpu: true

training:
  num_epochs: 10
  batch_size: 8
  checkpoint_frequency: 5
  enable_gradient_checkpointing: true
  epoch_save_interval: 1
  gradient_accumulation_steps: 1
  learning_rate: 0.00015
  loss:
    csi_loss:
      enabled: true
      magnitude_weight: 1.0
      phase_weight: 1.0
      normalize_weights: true
    csi_weight: 1.0
    pdp_loss:
      enabled: true
      fft_size: 2046
      normalize_pdp: true
      type: hybrid
    pdp_weight: 0.3
    regularization_loss:
      enabled: false
    regularization_weight: 0.0
    spatial_spectrum_loss:
      algorithm: bartlett
      enabled: false
      fusion_method: average
      loss_type: ssim
      orientation: bs  # Use BS antenna array (64 antennas) for Sionna
      phi_range:
      - 0.0
      - 10.0
      - 350.0
      ssim_k1: 0.01
      ssim_k2: 0.03
      ssim_window_size: 11
      theta_range:
      - 0
      - 5.0
      - 90.0
      # Subcarrier sampling optimization
      num_sampled_subcarriers: 1
      use_covariance_bartlett: false
      use_frequency_dependent_steering: true
    spatial_spectrum_weight: 0.0
  auto_checkpoint: true
  ray_chunk_size: 10
  scaling_factor: 1.0e-9
  weight_decay: 1.0e-05

user_equipment:
  num_ue_antennas: 1  # Sionna has 1 UE antenna
  antenna_array:
    configuration: "1x1"  # Sionna UE antenna array: single antenna
    spacing_x: 0.0429  # Antenna spacing in x direction (half wavelength at 3.5 GHz)
    spacing_y: 0.0429  # Antenna spacing in y direction (half wavelength at 3.5 GHz)
  ue_antenna_count: 1  # Number of UE antennas to use (1=antenna 0, 2=antennas 0,1, 3=antennas 0,1,2, etc.)

testing:
  ss_error:
    side: "bs"